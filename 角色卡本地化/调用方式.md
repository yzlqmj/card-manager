# 命令行工具 (cli.exe) 使用指南

本工具用于通过命令行对角色卡进行本地化处理，方便被其他脚本或程序调用。

---

## 核心用法

命令行工具的核心设计思路是 **“配置一次，多次使用”**。

1.  **配置 (可选)**: 首次使用时，可以通过命令行参数指定所有配置。更推荐的做法是，直接在 `config.json` 文件中设置好 `base_path` (酒馆public目录) 和 `proxy` (代理地址)。
2.  **使用**: 配置完成后，日常使用时仅需提供角色卡路径即可。

---

## 功能一：检查是否需要本地化

此功能快速判断角色卡内是否存在需要本地化的网络资源链接。它会直接返回 `True` 或 `False`，便于程序捕获结果。

### 命令格式

```shell
cli.exe "角色卡路径" --check
```

### 参数

-   `"角色卡路径"`: **(必需)** 目标 `.png` 文件的完整路径。**路径必须用双引号包裹**，以防路径中包含空格。
-   `--check`: **(必需)** 明确告知程序执行“检查”操作。

### 返回值

-   `True`: 卡片内有可本地化的资源。
-   `False`: 卡片内没有可本地化的资源。

### 示例

```shell
C:\> cli.exe "E:\Tavern\cards\some_character.png" --check
True
```

---

## 功能二：执行本地化

此功能会扫描、下载并替换角色卡内的所有网络资源，生成一张新的、已本地化的角色卡。

### 命令格式

```shell
cli.exe "角色卡路径" [可选参数...]
```

### 参数

-   `"角色卡路径"`: **(必需)** 目标 `.png` 文件的完整路径，**请务必使用双引号包裹**。

-   `--base-path "路径"`: **(可选)** 指定 SillyTavern 的 `public` 目录。如果省略，将自动从 `config.json` 读取。

-   `--proxy "地址"`: **(可选)** 指定下载用的代理服务器。如果省略，将自动从 `config.json` 读取。
    -   *示例: `--proxy "http://127.0.0.1:7890"`*

-   `--force-proxy-list "域名1" "域名2"`: **(可选)** 强制使用代理的域名列表（用空格隔开）。如果省略，将自动从 `config.json` 读取。

### 输出

-   处理日志会实时显示在命令行窗口。
-   成功后，新的角色卡会保存在原卡旁边的 `本地化` 文件夹内。

### 示例

#### 场景1: 依赖配置文件 (推荐)

假设 `config.json` 已配置好，这是最简洁的调用方式。

```shell
C:\> cli.exe "E:\Tavern\cards\another_character.png"
```

#### 场景2: 临时覆盖配置

使用命令行参数临时指定 `public` 目录和代理，本次运行会忽略 `config.json` 中的对应项。

```shell
C:\> cli.exe "E:\Tavern\cards\another_character.png" --base-path "D:\SillyTavern\public" --proxy "http://127.0.0.1:1233"